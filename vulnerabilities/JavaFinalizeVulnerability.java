import java.util.ArrayList;
import java.util.HashMap;
import java.util.HashSet;
import java.util.LinkedList;
import java.util.List;
import java.util.Map;

public class JavaFinalizeVulnerability {
	
	/*
	 * Analyze code for any instance of finalize without a call to super
	 */
	
	public List<Integer> run(Analyzer ana){
		JavaAnalyzer javaAn = (JavaAnalyzer) ana;
		//indication that the vulnerability may exist
		String bad = "finalize()";
		String good = "super.finalize()";
		
		String fileContents = javaAn.getFileContents().toLowerCase();
		boolean hasFinal = fileContents.contains(bad);
		List<Integer> vulnLines = new ArrayList<>();
		
		
		
		for(HashMap.Entry<Integer, String> e: javaAn.getLineToLine().entrySet())
		{
			if(e.getValue().toString().contains(bad) && !e.getValue().toString().contains(good))
			{
				vulnLines.add(e.getKey());
			}
		}
		
		
		
		
		return vulnLines;
		
		
	}

}
